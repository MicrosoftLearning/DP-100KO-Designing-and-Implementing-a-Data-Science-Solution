# 랩 4A: 데이터 저장소 사용

데이터 과학자는 보통 로컬 파일 시스템의 데이터를 사용합니다. 하지만 엔터프라이즈 환경에서는 여러 데이터 과학자가 액세스할 수 있는 중앙 위치에 데이터를 저장하는 방식이 더 효과적일 수 있습니다. 이 랩에서는 클라우드에 데이터를 저장하고 Azure Machine Learning *데이터 저장소*를 사용하여 해당 데이터에 액세스합니다.

## 시작하기 전에

이 랩을 시작하기 전에 [랩 1A](Lab01A.md) 및 [랩 1B](Lab01B.md)를 완료해야 합니다. 이 두 랩에는 이 랩에서 사용되는 Azure Machine Learning 작업 영역 및 기타 리소스를 만드는 작업이 포함되어 있습니다.

## 작업 1: Azure Storage 컨테이너 만들기
Azure Machine Learning에서는 여러 종류의 Azure 데이터 원본을 사용할 수 있습니다. 이 랩에서는 Blob 컨테이너가 포함된 Azure Storage 계정을 만듭니다.

1. [Azure Portal](https://portal.azure.com)에 로그인한 다음 Azure Machine Learning 작업 영역이 포함된 리소스 그룹을 엽니다. 이 그룹에는 작업 영역과 함께 만들어진 Azure Storage 계정이 이미 포함되어 있습니다.

    >**참고**: 작업 영역과 함께 만들어진 스토리지 계정은 서비스에서 구성 데이터, Notebook, 등록된 모델 등을 저장하는 데 사용됩니다. 이 계정을 사용하여 실험 및 모델 학습용 데이터를 저장할 수도 있습니다. 하지만 대부분의 경우에는 이 데이터를 별도로 관리합니다.

2. 다음 설정을 사용하여 리소스 그룹에 새 **스토리지 계정**을 추가합니다.

    - **스토리지 계정 이름**: 고유한 이름
    - **위치**: 작업 영역과 같은 위치
    - **성능**: 표준
    - **계정 종류**: StorageV2(범용 v2)
    - **복제**: LRS(로컬 중복 스토리지)
    - **액세스 계층(기본값)**: 핫
    - 네트워킹에는 기본 설정 사용

3. 스토리지 계정이 만들어질 때까지 기다렸다가 Portal에서 리소스로 이동합니다.
4. 스토리지 계정의 **컨테이너** 페이지를 열고 다음 설정을 사용하여 컨테이너를 추가합니다.

    - **이름**: aml-data
    - **공용 액세스 수준**: 개인(익명 권한 없음)

5. 컨테이너를 추가한 후 스토리지 계정의 **액세스 키** 페이지를 표시하여 **key1**을 클립보드에 복사합니다. 다음 작업에서 이 키가 필요합니다.

## 작업 2: Azure Machine Learning 데이터 저장소 등록

스토리지 컨테이너를 만들었으므로 Azure Machine Learning 작업 영역에 데이터 저장소로 등록할 수 있습니다.

1. [Azure Machine Learning Studio](https://ml.azure.com)에서 작업 영역의 **데이터 저장소** 페이지를 표시합니다. 미리 정의된 데이터 저장소의 목록이 표시됩니다.
2. 다음 설정을 사용하여 새 데이터 저장소를 만듭니다.
    - **데이터 저장소 이름**: aml_data
    - **데이터 저장소 유형**: Azure Blob Storage
    - **계정 선택 방법**: Azure 구독에서
    - **구독 ID**: *사용자의 Azure 구독*
    - **스토리지 계정**: *이전 작업에서 만든 스토리지 계정*
    - **Blob 컨테이너**: aml-data
    - **인증 유형**: 계정 키
    - **계정 키**: *이전 작업에서 복사한 키 붙여넣기*
3. 추가한 데이터 저장소가 **데이터 저장소** 페이지의 목록에 표시되는지 확인합니다.

## 작업 3: Azure Machine Learning SDK를 사용하여 데이터 저장소 액세스

이 작업에서는 Azure Machine Learning SDK를 사용하여 데이터 저장소에서 데이터를 업로드/다운로드합니다.

1. [Azure Machine Learning Studio](https://ml.azure.com)에서 작업 영역 **컴퓨팅** 페이지를 표시하고 **컴퓨팅 인스턴스** 탭에서 컴퓨팅 인스턴스를 시작합니다.
2. 컴퓨팅 인스턴스가 실행 중이면 인증된 세션이 만료되지 않도록 브라우저에서 Azure Machine Learning Studio 웹 페이지를 새로 고칩니다. 그런 다음 **Jupyter** 링크를 클릭하여 새 브라우저 탭에서 Jupyter 홈 페이지를 엽니다.
3. Jupyter 홈 페이지의 **Users/DP100** 폴더에서 **04A - Working with Datastores.ipynb** Notebook을 엽니다. 그런 다음 각 코드 셀을 차례로 실행하여 Notebook의 메모를 읽습니다.
4. Notebook에서 코드 실행이 완료되면 **파일** 메뉴에서 **닫기 및 중지**를 클릭하여 Notebook을 닫고 Python 커널을 종료합니다. 그런 후에 모든 Jupyter 브라우저 탭을 닫습니다.
5. Azure Machine Learning Studio의 **컴퓨팅** 페이지에서 컴퓨팅 인스턴스를 선택한 다음 **중지**를 클릭하여 인스턴스를 종료합니다.
